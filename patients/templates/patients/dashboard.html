{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="d-flex">
  <nav id="sidebar" class="bg-light border-end" style="width: 250px; min-height: 100vh;">
    <div class="sidebar-header p-3">
      <h4>E-Hospitality</h4>
      <p class="text-muted">Patient Dashboard</p>
    </div>
    <ul class="nav flex-column">
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'overview' %}active{% endif %}" href="{% url 'patients:overview' %}">Overview</a>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'appointments' %}active{% endif %}" href="{% url 'patients:appointments' %}">Appointments</a>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'medical_records' %}active{% endif %}" href="{% url 'patients:medical_records' %}">Medical Records</a>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'prescriptions' %}active{% endif %}" href="{% url 'patients:prescriptions' %}">Prescriptions</a>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'billing' %}active{% endif %}" href="{% url 'patients:billing' %}">Billing</a>
      </li>
      <li class="nav-item">
        <a class="nav-link {% if request.resolver_match.url_name == 'health_education' %}active{% endif %}" href="{% url 'patients:health_education' %}">Education</a>
      </li>
      <li class="nav-item mt-3">
        <a class="nav-link text-danger" href="{% url 'accounts:logout' %}">Logout</a>
      </li>
    </ul>
  </nav>
  <main class="flex-grow-1 p-4">
    {% block dashboard_content %}
    <h3>Welcome, {{ request.user.first_name }}!</h3>
    <p class="lead">This is your patient dashboard.</p>

    {% if upcoming_appointments %}
    <div class="alert alert-info" role="alert">
      You have {{ upcoming_appointments|length }} upcoming appointment{{ upcoming_appointments|length|pluralize }}.
    </div>
    {% endif %}

    {% if unpaid_bills %}
    <div class="alert alert-warning" role="alert">
      You have {{ unpaid_bills|length }} unpaid bill{{ unpaid_bills|length|pluralize }}. Please make payment.
    </div>
    {% endif %}

    <div class="row g-4 mt-3">
      <div class="col-md-3">
        <div class="card text-center h-100">
          <div class="card-body d-flex flex-column justify-content-center">
            <h5 class="card-title">Upcoming Appointments</h5>
            <p class="card-text">You have {{ upcoming_appointments|length }} upcoming appointment{{ upcoming_appointments|length|pluralize }}.</p>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card text-center h-100">
          <div class="card-body d-flex flex-column justify-content-center">
            <h5 class="card-title">Medical Records</h5>
            <p class="card-text">View your medical history and records.</p>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card text-center h-100">
          <div class="card-body d-flex flex-column justify-content-center">
            <h5 class="card-title">Active Prescriptions</h5>
            <p class="card-text">You have {{ active_prescriptions|length }} active prescription{{ active_prescriptions|length|pluralize }}.</p>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card text-center h-100">
          <div class="card-body d-flex flex-column justify-content-center">
            <h5 class="card-title">Outstanding Bills</h5>
            <p class="card-text">You have {{ unpaid_bills|length }} unpaid bill{{ unpaid_bills|length|pluralize }}.</p>
          </div>
        </div>
      </div>
    </div>
    {% endblock %}
  </main>
</div>
{% endblock %}
